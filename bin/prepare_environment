#!/usr/bin/env bash

echo "Check required software"
echo "========================"
command -v curl > /dev/null || ( echo "curl is not installed"; exit 1)
command -v git > /dev/null || ( echo "git is not installed"; exit 1)
command -v conda > /dev/null || ( echo "conda is not installed"; exit 1)
# make sure we have ~20GB available for uniref90
echo "ok"
echo ""

echo "Create conda environment"
echo "========================"
echo ""
conda config --add channels bioconda
conda env create -f pyl_protein_prediction.yml
#source activate pyl_protein_prediction
#pip install gooey
#source deactivate
echo ""

echo "Download UniRef90 database"
echo "=========================="
echo ""

if [ -f data/uniref90.fasta ] ; then
	echo "UniRef90 already exists at 'data/uniref90.fasta'. Skipping."
else
	echo "This may take several hours"
	curl ftp://ftp.uniprot.org/pub/databases/uniprot/uniref/uniref90/uniref90.fasta.gz -o data/uniref90.fasta.gz
	gunzip data/uniref90.fasta.gz
fi;
echo ""
